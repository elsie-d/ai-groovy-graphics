const { response } = require("express");
const { OpenAI } = require("openai");
const dotenv = require('dotenv').config();
const {Image,User} = require('../models');



const openai = new OpenAI({
  apiKey: process.env.OPENAI_API_KEY,
});

// // Set up the DALL-E endpoint
// const generateImage = app.post("/image", async (req, res) => {
//   // Get the prompt from the request
//   const { prompt } = req.body;

//   // Generate image from prompt
//   const response = await openai.createImage({
//     prompt: prompt,
//     n: 1,
//     size: "1024x1024",
//   });
//   // Send back image url
//   res.send(response.data.data[0].url);
// });  
const generateImage = async () =>{
  const response= await openai.images.generate({
    model:'dall-e-2',
    prompt: 'a polor bear eating icecream',
    n:1,
    size: "1024x1024"
  })
  
  const imageUrl= response.data
  const imageUrlList=imageUrl.map(image=>image.url)
  console.log(imageUrlList)
}

generateImage();

// const generateImage = async (req, res) => {
//   const { prompt, size } = req.body;

//   const imageSize =
//     size === 'small' ? '256x256' : size === 'medium' ? '512x512' : '1024x1024';

//   try {
//     const response = await openai.images.generate({
//       model: "dall-e-2",
//       prompt: "tiger",
//       n: 1,
//       size: imageSize,
//       response_format: "url",
//     });

//    response.created.toString.apply.arguments

//     res.status(200).json({
//       success: true,
//       data: imageUrl,
//     });
//   } catch (error) {
//     if (error.response) {
//       console.log(error.response.status);
//       console.log(error.response.data);
//     } else {
//       console.log(error.message);
//     }

//     res.status(400).json({
//       success: false,
//       error: 'The image could not be generated',
//     });
//   }
// };

module.exports = { generateImage };



